<?php

// 로그인 폼에서 받은 정보
$user_email = $_POST['userEmail'];
$user_password = $_POST['userPassword'];

$action = $_POST['action'];

// $action 인수에 따라 매핑 해주는 switch문
switch ($action)
{
    // 영화 상세정보
    case 'search' :
        $movie_seq = $_POST['movie_seq'];
        $vo = $sv->movieSearch($movie_seq);
        
        // VO클래스로 날아온 데이터 꺼내서 배열에 넣기
        $arr = array("movieTitle" => $vo->getMovieTitle(),
            "movieDirector" => $vo->getMovieDirector(),
            "movieStory" => $vo->getMovieStory(),
            "movieImage" => $vo->getMovieImage(),
            "openingDate" => $vo->getOpeningDate(),
            "movieSeq" => $vo->getMovieSeq());
        
        // JSON 방식으로 인코딩해서 출력
        $json = json_encode($arr);
        echo $json;
        
        //case 'search' 종료
        break;
        
        // 영화 리스트
    case 'list' :
        $voArray = $sv->movieList();
        $movie= array();
        
        foreach ($voArray as $arr)
        {
            array_push($movie, array(
                "movieTitle" => $arr->getMovieTitle(),
                "movieDirector" => $arr->getMovieDirector(),
                "movieStory" => $arr->getMovieStory(),
                "movieImage" => $arr->getMovieImage(),
                "openingDate" => $arr->getOpeningDate(),
                "movieSeq" => $arr->getMovieSeq()
            )
                );
        }
        
        // JSON 방식으로 인코딩해서 출력
        $json = json_encode($movie);
        echo $json;
        
        //case 'list' 종료
        break;
    default :
        echo '액션값 오류 : '.$action ;
}

